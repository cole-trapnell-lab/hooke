
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Maddy Duran">
      
      
        <link rel="canonical" href="https://cole-trapnell-lab.github.io/hooke/reference_brent/">
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>Reference brent - Hooke</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="trapnell" data-md-color-primary="indigo" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#description" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Hooke" class="md-header__button md-logo" aria-label="Hooke" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Hooke
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Reference brent
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/cole-trapnell-lab/hooke" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Hooke" class="md-nav__button md-logo" aria-label="Hooke" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Hooke
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/cole-trapnell-lab/hooke" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../background/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Background
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_type/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Type Requirements
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Example Datasets
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Differential Abundance
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Time Series Analysis
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<!-- toc -->

<p>November 13, 2023</p>
<h1 id="description">DESCRIPTION</h1>
<pre><code>Package: hooke
Title: Differential analysis of cell counts in single-cell experiments
Version: 0.0.1
Authors@R: 
    person(given = &quot;Madelein&quot;,
           family = &quot;Duran&quot;,
           role = c(&quot;aut&quot;, &quot;cre&quot;),
           email = &quot;duran@uw.edu&quot;)
    person(given = &quot;Cole&quot;,
           family = &quot;Trapnell&quot;,
           role = c(&quot;aut&quot;, &quot;cre&quot;),
           email = &quot;coletrap@uw.edu&quot;)
Description: Hooke models abundances of different cell types and how they change in single-cell genomics experiments.
License: MIT + file LICENSE
Encoding: UTF-8
LazyData: true
Roxygen: list(markdown = TRUE)
RoxygenNote: 7.2.1
LinkingTo: 
    Rcpp
Depends:
    Biobase, 
    monocle3,
    PLNmodels
Imports:
    assertthat (&gt;= 0.2.1),
    batchelor,
    BiocGenerics (&gt;= 0.28.0),
    dplyr (&gt;= 0.8.0.1),
    ggplot2 (&gt;= 3.1.1),
    ggrepel (&gt;= 0.8.1),
    grr,
    igraph (&gt;= 1.2.4),
    Matrix (&gt;= 1.2-17),
    methods,
    purrr (&gt;= 0.3.2),
    RColorBrewer,
    Rcpp (&gt;= 1.0.1),
    S4Vectors,
    stringr (&gt;= 1.4.0),
    tibble (&gt;= 2.1.1),
    tidyr (&gt;= 0.8.3),
    viridis (&gt;= 0.5.1),
    maxmatching,
    Rgraphviz,
    ggnetwork,
    tidygraph,
    ggforce,
    ggnewscale
Suggests: 
    testthat (&gt;= 2.1.0),
    pryr (&gt;= 0.1.4),
    knitr,
    rmarkdown,
    spelling
VignetteBuilder: knitr
Language: en-US```


# `add_umap_coords`

adds umap coords to a data frame


## Description

adds umap coords to a data frame


## Usage

```r
add_umap_coords(df, umap_centers)
</code></pre>
<h1 id="blacklist"><code>blacklist</code></h1>
<p>return the complementing edges</p>
<h2 id="description_1">Description</h2>
<p>return the complementing edges</p>
<h2 id="usage">Usage</h2>
<pre><code class="language-r">blacklist(edges)
</code></pre>
<h1 id="calc_max_flow"><code>calc_max_flow</code></h1>
<p>Calculate max flow between two points</p>
<h2 id="description_2">Description</h2>
<p>Calculate max flow between two points</p>
<h2 id="usage_1">Usage</h2>
<pre><code class="language-r">calc_max_flow(edges, source, target)
</code></pre>
<h1 id="calc_mst"><code>calc_mst</code></h1>
<p>Calculate a minimum spanning tree</p>
<h2 id="description_3">Description</h2>
<p>Calculate a minimum spanning tree</p>
<h2 id="usage_2">Usage</h2>
<pre><code class="language-r">calc_mst(edges, weight = &quot;pcor&quot;)
</code></pre>
<h1 id="calc_shortest_path"><code>calc_shortest_path</code></h1>
<p>Calculate the shortest path between two points</p>
<h2 id="description_4">Description</h2>
<p>Calculate the shortest path between two points</p>
<h2 id="usage_3">Usage</h2>
<pre><code class="language-r">calc_shortest_path(G, from, to)
</code></pre>
<h2 id="arguments">Arguments</h2>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>edges</code></td>
<td>data frame of edges with edge weights</td>
</tr>
</tbody>
</table>
<h2 id="value">Value</h2>
<p>data frame containing the shortest path</p>
<h1 id="cds"><code>cds</code></h1>
<p>Get the underlying cell_data_set object from a cell_count_model.</p>
<h2 id="description_5">Description</h2>
<p>Get the underlying cell_data_set object from a cell_count_model.</p>
<h2 id="usage_4">Usage</h2>
<pre><code class="language-r">cds(ccm)
</code></pre>
<h2 id="arguments_1">Arguments</h2>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ccm</code></td>
<td>A cell_count_model object.</td>
</tr>
</tbody>
</table>
<h2 id="value_1">Value</h2>
<p>A cell_data_set object</p>
<h2 id="examples">Examples</h2>
<pre><code class="language-r">cds(ccm)
</code></pre>
<h1 id="cell_count_model"><code>cell_count_model</code></h1>
<p>The cell_count_model class</p>
<h2 id="description_6">Description</h2>
<p>The main class used by Monocle3 to hold single-cell expression data.
 cell_count_model extends the Bioconductor SingleCellExperiment class.</p>
<h2 id="details">Details</h2>
<p>This class is initialized from a matrix of expression values along with cell
 and feature metadata.</p>
<h1 id="cell_count_set"><code>cell_count_set</code></h1>
<p>The cell_count_set class</p>
<h2 id="description_7">Description</h2>
<p>The main class used by Hooke to hold cell abundances data.
 cell_count_set extends the Monocle's cell_data_set class.</p>
<h2 id="details_1">Details</h2>
<p>This class is initialized from a matrix of expression values along with cell
 and feature metadata.</p>
<h1 id="centroids"><code>centroids</code></h1>
<p>Get the centroids of cell groups in UMAP/PCA space.</p>
<h2 id="description_8">Description</h2>
<p>Get the centroids of cell groups in UMAP/PCA space.</p>
<h2 id="usage_5">Usage</h2>
<pre><code class="language-r">centroids(ccs, reduction_method = &quot;UMAP&quot;, switch_group = NULL)
</code></pre>
<h2 id="arguments_2">Arguments</h2>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ccs</code></td>
<td>A cell_count_set object.</td>
</tr>
</tbody>
</table>
<h2 id="value_2">Value</h2>
<p>A data frame of centroid coordinates</p>
<h1 id="collect_pln_graph_edges"><code>collect_pln_graph_edges</code></h1>
<p>Orient graph edges from a PLNnetwork using a contrast between conditions</p>
<h2 id="description_9">Description</h2>
<p>Orient graph edges from a PLNnetwork using a contrast between conditions</p>
<h2 id="usage_6">Usage</h2>
<pre><code class="language-r">collect_pln_graph_edges(
  ccm,
  cond_b_vs_a_tbl,
  log_abundance_thresh = 1 - 5,
  model_for_pcors = &quot;reduced&quot;
)
</code></pre>
<h2 id="arguments_3">Arguments</h2>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ccm</code></td>
<td>A cell_count_model</td>
</tr>
<tr>
<td><code>cond_b_vs_a_tbl</code></td>
<td>A contrast between two conditions as returned by compare_abundances()</td>
</tr>
</tbody>
</table>
<h1 id="compare_abundances"><code>compare_abundances</code></h1>
<p>Compare two estimates of cell abundances from a Hooke model</p>
<h2 id="description_10">Description</h2>
<p>Compare two estimates of cell abundances from a Hooke model</p>
<h2 id="usage_7">Usage</h2>
<pre><code class="language-r">compare_abundances(ccm, cond_x, cond_y, method = &quot;BH&quot;)
</code></pre>
<h2 id="arguments_4">Arguments</h2>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ccm</code></td>
<td>A cell_count_model</td>
</tr>
<tr>
<td><code>cond_x</code></td>
<td>An estimate from estimate_abundances()</td>
</tr>
<tr>
<td><code>cond_y</code></td>
<td>An estimate from estimate_abundances()</td>
</tr>
</tbody>
</table>
<h2 id="value_3">Value</h2>
<p>A table contrasting cond_x and cond_y (interpret as Y/X)</p>
<h1 id="estimate_abundances"><code>estimate_abundances</code></h1>
<p>Predict cell type abundances given a PLN model and a set of inputs for its covariates</p>
<h2 id="description_11">Description</h2>
<p>Predict cell type abundances given a PLN model and a set of inputs for its covariates</p>
<h2 id="usage_8">Usage</h2>
<pre><code class="language-r">estimate_abundances(ccm, newdata, min_log_abund = -5)
</code></pre>
<h2 id="arguments_5">Arguments</h2>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>newdata</code></td>
<td>needs to be suitable input to pln_model</td>
</tr>
</tbody>
</table>
<h1 id="get_paga_graph"><code>get_paga_graph</code></h1>
<p>Extract a partitioned abstract graph from a Monocle cell_data_set object</p>
<h2 id="description_12">Description</h2>
<p>QUESTION: Do the cells need to be grouped by monocle cluster? Or can they
 be grouped arbitrarily (e.g. by cell type? Would be good to generalize if
 possible. For now, only works when cells are grouped by Monocle cluster</p>
<h2 id="usage_9">Usage</h2>
<pre><code class="language-r">get_paga_graph(cds, reduction_method = &quot;UMAP&quot;)
</code></pre>
<h2 id="arguments_6">Arguments</h2>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>cds</code></td>
<td>A cell_data_set object. cluster_cells() must have been called.</td>
</tr>
<tr>
<td><code>reduction_method</code></td>
<td>The coordinate space in which to build the graph</td>
</tr>
</tbody>
</table>
<h1 id="get_pcor_edges"><code>get_pcor_edges</code></h1>
<p>returns edges based on pcor values</p>
<h2 id="description_13">Description</h2>
<p>returns edges based on pcor values</p>
<h2 id="usage_10">Usage</h2>
<pre><code class="language-r">get_pcor_edges(ccm, selected_model = c(&quot;reduced&quot;, &quot;full&quot;))
</code></pre>
<h1 id="hello"><code>hello</code></h1>
<p>Hello, World!</p>
<h2 id="description_14">Description</h2>
<p>Prints 'Hello, world!'.</p>
<h2 id="usage_11">Usage</h2>
<pre><code class="language-r">hello()
</code></pre>
<h2 id="examples_1">Examples</h2>
<pre><code class="language-r">hello()
</code></pre>
<h1 id="init_penalty_matrix"><code>init_penalty_matrix</code></h1>
<p>Initialize the PLN network penalty matrix, accepting optional whitelists and
 blacklists of edges that are "free" or "off limits" between cell groups</p>
<h2 id="description_15">Description</h2>
<p>Initialize the PLN network penalty matrix, accepting optional whitelists and
 blacklists of edges that are "free" or "off limits" between cell groups</p>
<h2 id="usage_12">Usage</h2>
<pre><code class="language-r">init_penalty_matrix(
  ccs,
  whitelist = NULL,
  blacklist = NULL,
  base_penalty = 1,
  min_penalty = 0.01,
  max_penalty = 1e+06
)
</code></pre>
<h2 id="arguments_7">Arguments</h2>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ccs</code></td>
<td>A cell_count_set of aggregated cell counts</td>
</tr>
<tr>
<td><code>whitelist</code></td>
<td>a data frame with two columns corresponding to (undirected) edges that should receive no penalty</td>
</tr>
<tr>
<td><code>blacklist</code></td>
<td>a data frame with two columns corresponding to (undirected) edges that should receive very high penalty</td>
</tr>
<tr>
<td><code>dist_fun</code></td>
<td>A function that returns a penalty based given a distance between two clusters</td>
</tr>
</tbody>
</table>
<h1 id="model"><code>model</code></h1>
<p>Get the selected PLNnetwork from a cell_count_model object.</p>
<h2 id="description_16">Description</h2>
<p>Get the selected PLNnetwork from a cell_count_model object.</p>
<h2 id="usage_13">Usage</h2>
<pre><code class="language-r">model(ccm, model_to_return = c(&quot;full&quot;, &quot;reduced&quot;))
</code></pre>
<h2 id="arguments_8">Arguments</h2>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ccm</code></td>
<td>A cell_count_model object.</td>
</tr>
</tbody>
</table>
<h2 id="value_4">Value</h2>
<p>An updated cell_count_model object</p>
<h2 id="examples_2">Examples</h2>
<pre><code class="language-r">model(ccm)
</code></pre>
<h1 id="new_cell_count_model"><code>new_cell_count_model</code></h1>
<p>Create a new cell_count_model object.</p>
<h2 id="description_17">Description</h2>
<p>Fits a PLNnetwork according to a formula. Accepts a matrix of penalties as a
 way of encoding a graph prior. Automatically selects sparsity parameter, but
 allows user to update it.</p>
<h2 id="usage_14">Usage</h2>
<pre><code class="language-r">new_cell_count_model(
  ccs,
  main_model_formula_str,
  nuisance_model_formula_str = &quot;1&quot;,
  penalty_matrix = NULL,
  whitelist = NULL,
  blacklist = NULL,
  sparsity_factor = 0.1,
  base_penalty = 1,
  min_penalty = 0.01,
  max_penalty = 1e+06,
  verbose = FALSE,
  pseudocount = 0,
  pln_min_ratio = 0.001,
  pln_num_penalties = 30,
  size_factors = NULL,
  ...
)
</code></pre>
<h2 id="arguments_9">Arguments</h2>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ccs</code></td>
<td>A Hooke cell_count_set object.</td>
</tr>
<tr>
<td><code>main_model_formula_str</code></td>
<td>A character string specifying the model of cell abundances across samples, where terms refer to columns in <code>colData(ccs)</code> . Put main effects here.</td>
</tr>
<tr>
<td><code>nuisance_model_formula_str</code></td>
<td>A character string specifying the model of cell abundances across samples. Put nuisance effects here.</td>
</tr>
<tr>
<td><code>penalty_matrix</code></td>
<td>A numeric NxN symmetric matrix specifying penalties for the PLN model, where N is the number of cell types. Entries must be positive. Use to specify an undirected graph prior for the PLN model.</td>
</tr>
<tr>
<td><code>sparsity_factor</code></td>
<td>A positive number to control how sparse the PLN network is. Larger values make the network more sparse.</td>
</tr>
</tbody>
</table>
<h2 id="value_5">Value</h2>
<p>a new cell_count_model object</p>
<h1 id="new_cell_count_set"><code>new_cell_count_set</code></h1>
<p>Create a new cell_data_set object.</p>
<h2 id="description_18">Description</h2>
<p>Create a new cell_data_set object.</p>
<h2 id="usage_15">Usage</h2>
<pre><code class="language-r">new_cell_count_set(
  cds,
  sample_group,
  cell_group,
  sample_metadata = NULL,
  cell_metadata = NULL,
  lower_threshold = NULL,
  upper_threshold = NULL
)
</code></pre>
<h2 id="arguments_10">Arguments</h2>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>cds</code></td>
<td>A Monocle cell data set object.</td>
</tr>
<tr>
<td><code>sample_group</code></td>
<td>A column in colData(cds) that specifes how cells are grouped into samples</td>
</tr>
<tr>
<td><code>cell_group</code></td>
<td>A column in colData(cds) that specifies how cells are grouped into types or states (e.g. cluster)</td>
</tr>
<tr>
<td><code>sample_metadata</code></td>
<td>data frame containing attributes of individual samples, where</td>
</tr>
<tr>
<td><code>cell_metadata</code></td>
<td>data frame containing attributes of individual cell groups, where <code>row.names(cell_metadata)</code> are entries in <code>cell_group</code></td>
</tr>
</tbody>
</table>
<h2 id="value_6">Value</h2>
<p>a new cell_data_set object</p>
<h1 id="plot_contrast"><code>plot_contrast</code></h1>
<p>Plot a UMAP colored by how cells shift in a given contrast</p>
<h2 id="description_19">Description</h2>
<p>Plot a UMAP colored by how cells shift in a given contrast</p>
<h2 id="usage_16">Usage</h2>
<pre><code class="language-r">plot_contrast(
  ccm,
  cond_b_vs_a_tbl,
  log_abundance_thresh = -5,
  scale_shifts_by = c(&quot;receiver&quot;, &quot;sender&quot;, &quot;none&quot;),
  edge_size = 2,
  cell_size = 1,
  q_value_thresh = 1,
  group_label_size = 2,
  plot_labels = c(&quot;significant&quot;, &quot;all&quot;, &quot;none&quot;),
  fc_limits = c(-3, 3),
  sender_cell_groups = NULL,
  receiver_cell_groups = NULL,
  plot_edges = c(&quot;all&quot;, &quot;directed&quot;, &quot;undirected&quot;, &quot;none&quot;),
  label_cell_groups = list(),
  repel_labels = TRUE,
  model_for_pcors = &quot;reduced&quot;,
  switch_label = NULL,
  sub_cds = NULL,
  alpha = 1,
  x = 1,
  y = 2
)
</code></pre>
<h2 id="arguments_11">Arguments</h2>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ccm</code></td>
<td>A cell_count_model object.</td>
</tr>
<tr>
<td><code>criterion</code></td>
<td>a character string specifying the PLNmodels criterion to use. Must be one of "BIC", "EBIC" or "StARS".</td>
</tr>
</tbody>
</table>
<h2 id="value_7">Value</h2>
<p>an updated cell_count_model object</p>
<h1 id="select_model"><code>select_model</code></h1>
<p>Select the model a cell_count_model should use</p>
<h2 id="description_20">Description</h2>
<p>Select the model a cell_count_model should use</p>
<h2 id="usage_17">Usage</h2>
<pre><code class="language-r">select_model(
  ccm,
  criterion = &quot;EBIC&quot;,
  sparsity_factor = 1,
  models_to_update = c(&quot;both&quot;, &quot;full&quot;, &quot;reduced&quot;)
)
</code></pre>
<h2 id="arguments_12">Arguments</h2>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ccm</code></td>
<td>A cell_count_model object.</td>
</tr>
<tr>
<td><code>criterion</code></td>
<td>a character string specifying the PLNmodels criterion to use. Must be one of "BIC", "EBIC" or "StARS".</td>
</tr>
</tbody>
</table>
<h2 id="value_8">Value</h2>
<p>an updated cell_count_model object</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy 2023 <a href="https://github.com/cole-trapnell-lab"  target="_blank" rel="noopener">Cole Trapnell</a>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>